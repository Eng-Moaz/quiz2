<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
  <title>EST I - Writing Quiz</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .main-container {
      width: 100%;
      max-width: 650px;
      background: #ffffff;
      border-radius: 12px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      max-height: 90vh;
    }

    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 20px 16px;
      text-align: center;
    }

    .header h1 {
      font-size: 24px;
      margin-bottom: 4px;
    }

    .header p {
      font-size: 13px;
      opacity: 0.9;
    }

    .content {
      flex: 1;
      overflow-y: auto;
      padding: 20px 16px;
    }

    .start-screen {
      text-align: center;
    }

    .start-screen h2 {
      font-size: 28px;
      color: #333;
      margin-bottom: 16px;
    }

    .start-screen .info {
      font-size: 15px;
      color: #666;
      line-height: 1.6;
      margin-bottom: 28px;
      background: #f5f5f5;
      padding: 16px;
      border-radius: 8px;
    }

    .start-screen .info strong {
      color: #333;
      display: block;
      margin-top: 8px;
    }

    .quiz-screen {
      display: none;
    }

    .timer-bar {
      background: #fff3cd;
      border-bottom: 2px solid #ffc107;
      padding: 12px 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: bold;
      margin-bottom: 16px;
    }

    .timer-display {
      font-size: 18px;
      color: #d32f2f;
      letter-spacing: 1px;
    }

    .question-counter {
      font-size: 13px;
      color: #666;
    }

    .passage-box {
      background: #f0f7ff;
      border-left: 4px solid #667eea;
      padding: 12px;
      margin-bottom: 16px;
      border-radius: 4px;
      max-height: 200px;
      overflow-y: auto;
      font-size: 13px;
      color: #333;
      line-height: 1.5;
    }

    .question-header {
      font-size: 12px;
      color: #667eea;
      font-weight: bold;
      margin-bottom: 8px;
    }

    .question-text {
      font-size: 16px;
      color: #222;
      margin-bottom: 16px;
      line-height: 1.6;
    }

    .options-group {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-bottom: 16px;
    }

    .option-button {
      padding: 14px 14px;
      border: 2px solid #e0e0e0;
      background: #ffffff;
      border-radius: 8px;
      cursor: pointer;
      font-size: 15px;
      text-align: left;
      transition: all 0.25s ease;
    }

    .option-button:hover:not(:disabled) {
      background: #f5f5f5;
      border-color: #667eea;
    }

    .option-button.correct {
      background: #d4edda;
      border-color: #28a745;
      color: #155724;
    }

    .option-button.incorrect {
      background: #f8d7da;
      border-color: #f5222d;
      color: #721c24;
    }

    .option-button:disabled {
      cursor: default;
    }

    .feedback-message {
      min-height: 20px;
      font-size: 14px;
      font-weight: bold;
      margin-bottom: 12px;
    }

    .feedback-message.correct {
      color: #28a745;
    }

    .feedback-message.incorrect {
      color: #f5222d;
    }

    .button-group {
      display: flex;
      gap: 10px;
      margin-top: 16px;
    }

    .btn {
      padding: 12px 18px;
      border: none;
      border-radius: 8px;
      font-size: 15px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.25s ease;
      flex: 1;
    }

    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    .btn-primary:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
    }

    .btn-primary:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    .btn-start {
      width: 100%;
      padding: 16px;
      font-size: 18px;
      margin-top: 24px;
    }

    .end-screen {
      display: none;
      text-align: center;
    }

    .end-screen h2 {
      font-size: 28px;
      color: #667eea;
      margin-bottom: 16px;
    }

    .score-display {
      font-size: 36px;
      font-weight: bold;
      color: #333;
      margin-bottom: 8px;
    }

    .score-message {
      font-size: 15px;
      color: #666;
      margin-bottom: 24px;
    }

    .review-screen {
      display: none;
    }

    .review-header {
      font-size: 20px;
      color: #667eea;
      font-weight: bold;
      margin-bottom: 16px;
      text-align: center;
    }

    .review-item {
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      padding: 14px;
      margin-bottom: 14px;
      background: #fafafa;
    }

    .review-item-title {
      font-weight: bold;
      color: #667eea;
      margin-bottom: 8px;
      font-size: 14px;
    }

    .review-item-passage {
      background: #f0f7ff;
      padding: 8px;
      border-radius: 4px;
      font-size: 12px;
      color: #555;
      margin-bottom: 8px;
      line-height: 1.4;
      max-height: 120px;
      overflow-y: auto;
    }

    .review-item-question {
      font-size: 14px;
      color: #333;
      margin-bottom: 8px;
      line-height: 1.5;
    }

    .review-answer {
      margin-bottom: 6px;
      font-size: 13px;
    }

    .review-answer.user {
      color: #f5222d;
    }

    .review-answer.correct {
      color: #28a745;
    }

    .back-button {
      width: 100%;
      margin-top: 16px;
    }

    ::-webkit-scrollbar {
      width: 6px;
    }

    ::-webkit-scrollbar-track {
      background: #f1f1f1;
    }

    ::-webkit-scrollbar-thumb {
      background: #888;
      border-radius: 3px;
    }

    @media (max-width: 480px) {
      .main-container {
        border-radius: 0;
        max-height: 100vh;
      }

      .header {
        padding: 16px 12px;
      }

      .content {
        padding: 16px 12px;
      }

      .option-button {
        font-size: 14px;
        padding: 12px 12px;
      }

      .question-text {
        font-size: 15px;
      }

      .btn {
        font-size: 14px;
        padding: 10px 14px;
      }
    }
  </style>
</head>
<body>
  <div class="main-container">
    <div class="header">
      <h1>EST I - Writing Quiz</h1>
      <p>Official Test - 35 Minutes - 44 Questions</p>
    </div>

    <div class="content">
      <div class="start-screen" id="startScreen">
        <h2>Welcome</h2>
        <div class="info">
          <strong>üìù Complete the EST Writing Exam</strong>
          You have 35 minutes to answer all 44 multiple-choice questions.
          <strong style="margin-top: 8px;">üí° Tip:</strong> Read each passage carefully before answering questions.
          <strong style="margin-top: 8px;">‚è±Ô∏è Timer:</strong> Countdown starts when you click Start.
        </div>
        <button class="btn btn-primary btn-start" id="startBtn">Start Quiz</button>
      </div>

      <div class="quiz-screen" id="quizScreen">
        <div class="timer-bar">
          <div class="timer-display" id="timer">35:00</div>
          <div class="question-counter" id="counter">Question 1 of 44</div>
        </div>
        <div class="passage-box" id="passageBox"></div>
        <div class="question-header" id="questionHeader"></div>
        <div class="question-text" id="questionText"></div>
        <div class="options-group" id="optionsGroup"></div>
        <div class="feedback-message" id="feedback"></div>
        <div class="button-group">
          <button class="btn btn-primary" id="nextBtn" disabled>Next ‚Üí</button>
        </div>
      </div>

      <div class="end-screen" id="endScreen">
        <h2>Quiz Complete!</h2>
        <div class="score-display" id="scoreDisplay">0/0</div>
        <div class="score-message" id="scoreMessage"></div>
        <button class="btn btn-primary" id="reviewBtn">Review Wrong Answers</button>
        <button class="btn btn-primary" style="background: #999; margin-top: 8px;" id="restartBtn">Start Over</button>
      </div>

      <div class="review-screen" id="reviewScreen">
        <div class="review-header">Wrong Answers Review</div>
        <div id="reviewList"></div>
        <button class="btn btn-primary back-button" id="backBtn">Back to Results</button>
      </div>
    </div>
  </div>

  <script>
    // ==================== COMPLETE QUIZ DATA ====================
    const quizData = [
      {
        passage: `PASSAGE 1 ‚Äì The Montessori Method

The lessons are individual, and brevity must be one of their chief characteristics. Dante gives excellent advice to teachers when he says, "Let thy words be counted." The more carefully we cut away useless words, the more perfect will become the lesson. And in preparing the lessons which she is to give, the teacher must pay special attention to this point, counting and weighing the value of the words which she is to speak.

Another characteristic quality of the lesson in the "Children's Houses" is its simplicity. It must be obtained of all that is not absolute truth. That the teacher must not lose herself in vain words, is included in the first quality of conciseness; this second, then, is closely related to the first: that is, the carefully chosen words must be the most simple it is possible to find, and must refer to the truth.

The third quality of the lesson is its objectivity. Objectivity, opposite to subjectivity, remains essential when planning a lesson. There shall remain in evidence only the object to which she wishes to call the attention of the child. This brief and simple lesson must be considered by the teacher as an explanation of the object and of the use which the child can make of it.

In the giving of such lessons the fundamental guide must be the method of observation, in which is included and understood the liberty of the child. And she must take great care not to offend the principles of liberty.

For, if she has provoken the child to make an unnatural effort, she will no longer know what is the spontaneous activity of the child. If, therefore, the lesson rigorously prepared in this brevity, simplicity, and truth is not understood by the child, is not accepted by him as an explanation of the object, the teacher must be warned of two things: first, not to insist by repeating the lesson; and second, not to make the child feel that he has made a mistake, or that he is not understood. In doing so she will cause him to make an effort to understand, and will thus alter the natural state which must be used by her in making her psychological observation. A few examples may serve to illustrate this point.

Let us suppose, for example, that the teacher thinks to teach a child the two colours, red and blue. She desires to attracting the attention of the child to the object. She says, therefore, "Look at this." Then, in order to teach the colours, she says, showing him the red, "This is red," raising her voice a little and pronouncing the word "red" slowly and clearly; then showing him the other colour, "This is blue." Losing track that the child has understood, she says to him, "Give me the red,"‚Äî"Give me the blue." Let us suppose that the child in following this last direction makes a mistake. The teacher does not repeat and does not insist; she smiles, gives the child a friendly caress and takes away the colours.`,
        questions: [
          {q: "And in preparing the lessons which she is to give, the teacher must pay special attention to this point, counting and weighing the value of the words which she is to speak.\n\nWhich beginning is best?", opts: ["NO CHANGE", "But in preparing the lessons which she is to give", "As well as preparing the lessons which she is to give", "Frankly speaking, in preparing the lessons which she is to give"], ans: 0},
          {q: "It must be ___ of all that is not absolute truth.", opts: ["obtained", "stripped", "removed", "rejected"], ans: 1},
          {q: "That the teacher must not lose herself in vain words, is included in the first quality of conciseness; this second, then, is closely related to the first‚Ä¶", opts: ["NO CHANGE", "conciseness, this second,", "conciseness‚Äîthis second,", "conciseness ‚Ä¶ this second,"], ans: 0},
          {q: "Which of the following statements best explains objectivity?", opts: ["Objectivity, opposite to subjectivity, remains essential when planning a lesson.", "Objectivity can often be a fundamental aspect of teaching.", "Objectivity is the action of removing one's self from the subject at hand.", "The lesson must be presented in such a way that the personality of the teacher shall disappear."], ans: 3},
          {q: "The writer would like to insert this sentence: 'So the teacher shall observe whether the child interests himself in the object, how he is interested in it, for how long, etc., even noticing the expression of his face.' The best placement is:", opts: ["before sentence 1.", "before sentence 2.", "before sentence 3.", "after sentence 3."], ans: 1},
          {q: "For, if she ___ the child to make an unnatural effort‚Ä¶", opts: ["has provoken", "had provoken", "provokes", "provoke"], ans: 2},
          {q: "‚Ä¶the teacher must be warned of two things: first, not to insist by repeating the ___ lesson; and second‚Ä¶", opts: ["NO CHANGE", "lesson, and second,", "lesson and second,", "lesson‚Äî and second,"], ans: 0},
          {q: "Let us suppose, that the teacher ___ to teach a child the two colours, red and blue. Which choice best expresses the teacher's own motivation?", opts: ["thinks", "wishes", "is asked", "needs"], ans: 1},
          {q: "She desires ___ attracting the attention of the child to the object.", opts: ["to attracting", "attracting", "to attracts", "to attract"], ans: 3},
          {q: "___ that the child has understood, she says to him, 'Give me the red,'‚Äî'Give me the blue.'", opts: ["Losing track", "To make sure", "Reiterating after", "With careful precision"], ans: 1},
          {q: "The teacher does not repeat and does not insist; she smiles, gives the child a friendly caress and takes away the colours. Which choice uses the most appropriate punctuation?", opts: ["NO CHANGE", "she smiles, gives the child, a friendly caress and takes away the colours.", "she smiles gives the child a friendly caress and takes away the colours.", "she smiles, gives the child a friendly caress, and takes away the colours."], ans: 3}
        ]
      },
      {
        passage: `PASSAGE 2 ‚Äì Music

Music deals first of all with feeling or emotion. But since emotion may be guided by the mind and transfused by the imagination since emotion is not a separate and isolated part of our being‚Äîso music may be so ordered by the mind and so transfused by the imagination as to become intellectual and imaginative. It is true that the greater part of the music produced and performed deals only with emotion, but this is equally true of literature. The popular novel is one tenth emotion, one tenth mind, and the rest imagination. Moreover, it is with music, though such illogical invention as one constantly finds in many popular novels would be intolerable in any music. Since there seems to be an incongruity between the statement that music has no definite meaning and the statement that it is intellectual, this leaves no room for reconciliation.

We must first of all distinguish between the quality itself and the expression of the quality. A person may have a mind stored with wisdom and be completely what we call "intellectual," without ever expressing himself by a spoken or written word. His wisdom exists by itself and for itself, entirely separated from their expression. If he expresses himself, and with skill, we call that expression literature, but, in any case, it remains wisdom. And what is wisdom? It is what Mr. Eliot describes a liberal education to be‚Äî"a state of mind:" it is the fusion of knowledge with experience, with feeling, and imagination.

Now words are symbols which diminish in their efficacy as they try to compass feeling and imagination. If the wise man is cold, he can say, "I am cold:" but if he wishes to tell you of his idea of God, he has no words adequate for the purpose, because he is dealing with something which is not in the domain of knowledge alone‚Äîwhich he can feel, or perhaps imagine, but cannot define. The reason alone never even touches the far-away circle of that perfection which we believe to exist, and the subtle inner relations between man and the visible and invisible world refuse to be harnessed to language. For these he finds expression in some form of beauty. "The beautiful," says Goethe, "is a manifestation of the secret laws of nature which, but for this appearance, had been forever concealed from us."

So we say that in wisdom the qualities we call insight, feeling, and imagination must find for themselves some more plastic medium of expression than language. And when that plastic medium, though non-definitive, has those qualities of subjectivity, continuity, and form which are essential to all intellectual expression, we are justified in calling it "intellectual." Let us take for our specific illustration the first movement of the Ninth Symphony of Beethoven. It is impossible to imagine this as an expression of feeling only, untouched by thought or by imagination. The inevitable conclusion arrived at by any person who's understands it is that the feeling is absolutely controlled by the mind, and that it is imagination that gives it its extraordinary effect.`,
        questions: [
          {q: "But since emotion may be guided by the mind and transfused by the imagination ___ emotion is not a separate and isolated part of our being‚Äîso music may be so ordered‚Ä¶", opts: ["NO CHANGE", "since, emotion is not a separate and isolated part of our being‚Äîso", "since, emotion is not a separate and isolated part of our being so", "since‚Äîemotion is not a separate and isolated part of our being‚Äîso"], ans: 3},
          {q: "The popular novel is one tenth emotion, one tenth mind, and the rest imagination. ___ it is with music, though such illogical invention‚Ä¶", opts: ["Moreover,", "So", "In fact", "Regardless"], ans: 1},
          {q: "Since there seems to be an incongruity between music having no definite meaning and being intellectual, ___.", opts: ["this leaves no room for reconciliation.", "it has caused an even further gap.", "let us take a specific illustration and see if we cannot reconcile.", "reconciliation proves difficult."], ans: 2},
          {q: "Should the sentence 'We must first of all distinguish...' be kept or deleted?", opts: ["Kept, provides detailed support.", "Kept, introduces paragraph and transitions.", "Deleted, unrelated.", "Deleted, details misplaced."], ans: 1},
          {q: "His wisdom exists by itself, entirely separated from ___ expression.", opts: ["NO CHANGE", "its'", "its", "it's"], ans: 2},
          {q: "It is the fusion of ___ knowledge with experience, with feeling, and imagination.", opts: ["knowledge with experience, with feeling, and imagination.", "knowledge with experience, with feeling, and with imagination.", "knowledge with experience, feeling, and with imagination.", "knowledge with experience, feeling, and the imagination."], ans: 1},
          {q: "Now words are symbols which ___ in their efficacy as they try to compass feeling and imagination.", opts: ["diminish", "change", "disrupt", "improve"], ans: 0},
          {q: "Should the quotation marks around 'The beautiful' be removed?", opts: ["Yes, represents inner thoughts.", "Yes, inconsistent with style.", "No, serve to break flow.", "No, symbolize word-for-word account."], ans: 3},
          {q: "‚Ä¶has those qualities of ___, continuity, and form which are essential‚Ä¶", opts: ["subjectivity", "objectivity", "rarity", "unstructured"], ans: 1},
          {q: "The inevitable conclusion arrived at by any person ___ understands it‚Ä¶", opts: ["who's", "which", "whom", "that"], ans: 3},
          {q: "Which choice best concludes and matches the author's style?", opts: ["Is imagination the key?", "Music expresses what words cannot.", "That being said, music becomes a language through imagination‚Ä¶", "Expression peaks when involving music."], ans: 2}
        ]
      },
      {
        passage: `PASSAGE 3 ‚Äì The Story of Geographical Discovery

If one looks at the west coast of Australia one is struck by the large number of Dutch names which are jotted down the coast. There is Hoog Island, Diemen's Bay, Houtman's Abrolhos, De Wit land, and the Archipelago of Nuyts, besides Dirk Hartog's Island and Cape Leeuwin. To the extreme north we find the Gulf of Carpentaria, and to the extreme south the island which used to be called Van Diemen's Land. It is not altogether to be wondered at that almost to the middle of this century the land we now call Australia was tolerably well known as New Holland. The Portuguese and Dutch had made considerable progress in delineating its coast. The Dutch ships which came in from the East Indies to the Cape of Good Hope were for many years in the habit of ranging down the western coast, and at different seasons of the year the whole of that coast had been fairly well explored. It was on a coast thus familiar to mariners that no permanent settlement was made until comparatively recent times.`,
        questions: [
          {q: "‚Ä¶mariners portulanos gave a rude yet ___ account of the littoral of Africa‚Ä¶", opts: ["effective", "subjective", "unprecedented", "tactful"], ans: 0},
          {q: "‚Ä¶but they settled upon it, at Amina on the Guinea coast‚Ä¶", opts: ["NO CHANGE", "it‚Äî at", "it. At", "it at"], ans: 2},
          {q: "‚Ä¶and afterwards celebrated by Milton‚Ä¶", opts: ["NO CHANGE", "as time gradually passes by", "unknowingly", "certainly enough"], ans: 0},
          {q: "‚Ä¶in some maps of the sixteenth and 17th century‚Ä¶", opts: ["NO CHANGE", "seventeenth", "seventh", "seventeen"], ans: 1},
          {q: "Best structure: We ___ terminated in three large lakes‚Ä¶", opts: ["We, which can be scarcely other than Victoria, see it terminated in three large lakes.", "We see it, which can be scarcely other than Victoria, terminated in three large lakes.", "We see it terminated, which can be Victoria, in three large lakes.", "We see it terminated in three large lakes, which can be scarcely other than Victoria."], ans: 0},
          {q: "Sentence 5 should be placed:", opts: ["where it is now", "before sentence 1", "after sentence 2", "after sentence 6"], ans: 0},
          {q: "‚Ä¶at least ___ the sources of the Nile.", opts: ["with regard to", "in comparison to", "because of", "due to"], ans: 0},
          {q: "It is remarkable that all four rivers ___ had their course determined‚Ä¶", opts: ["has", "had has", "have had", "had had"], ans: 2},
          {q: "It is not inappropriate that, ___ in the case of the Congo‚Ä¶", opts: ["NO CHANGE", "except", "exempt", "expect"], ans: 1},
          {q: "What about the parentheses?", opts: ["Keep. Nonrestrictive.", "Keep. Change in tone.", "Delete. Necessary.", "Delete. Wrong position."], ans: 0},
          {q: "‚Ä¶at least that seems to be the ___.", opts: ["suggestion", "input", "explicit meaning", "uncertainty"], ans: 0}
        ]
      },
      {
        passage: `PASSAGE 4 ‚Äì Ice-Cave

As we stood at the mouth of the low entrance, making final preparations for a plunge into the darkness, I perceived a strong cold current blowing out from the cave‚Äîsufficiently strong and cold to render knickerbocker stockings a very unavailing protection. While engaged in the discovery that this style of dress is not without its drawbacks, I found, to my surprise, that the direction of the current suddenly changed, and the cold blast which had before blown out of the cave, now blew almost as strongly in. The arch of entrance was so low, that the top was about on a level with my waist; so that our faces and the upper parts of our bodies were not exposed to the current, and the strangeness of the effect was thus considerably increased. As a matter of curiosity, we lighted a bougie, and placed it on the edge of the snow, and were much surprised to find that it melted very slowly, and the snow actually melted faster on the side furthest from the flame!`,
        questions: [
          {q: "Best rewrite: 'While engaged in the discovery that this style of dress is not without its drawbacks‚Ä¶'", opts: ["NO CHANGE", "While engaged, I found, discovering drawbacks‚Ä¶", "While engaged in discovering, to my surprise, the direction changed‚Ä¶", "While engaged, to my surprise, discovering drawbacks‚Ä¶"], ans: 0},
          {q: "As a matter of curiosity, we lighted a ___, and placed it on the edge of the snow‚Ä¶", opts: ["bougie", "bougie (capitalization)", "bougie (spelling)", "(bougie)"], ans: 1},
          {q: "‚Ä¶and placed ___ on the edge of the snow‚Ä¶", opts: ["it", "its", "her", "their"], ans: 0},
          {q: "Keep or delete the portion about the experiment?", opts: ["Keep. Provides necessary information.", "Keep. Creates link.", "Delete. Distracts.", "Delete. Unrelated."], ans: 0},
          {q: "‚Ä¶a storm might have raged outside without producing effect below like ___.", opts: ["the terrorization of crows.", "a snowstorm hitting your house.", "a tornado hitting your home.", "being poisoned by a berry."], ans: 2},
          {q: "It would be difficult to explain, ___ it is not so difficult to see oscillation.", opts: ["NO CHANGE", "because", "and", "but"], ans: 3},
          {q: "The author wants to express movement. Best choice?", opts: ["oscillation", "hesitation", "immobility", "idleness"], ans: 0},
          {q: "Best intro to the next paragraph?", opts: ["Ice-cave frozen.", "Difficult floor plan.", "We passed down through the archway and stood on the floor.", "Floor plan complex."], ans: 2},
          {q: "As our eyes became accustomed, we saw ___, an indistinct light‚Ä¶", opts: ["someone", "something", "everyone", "everything"], ans: 1},
          {q: "Best emphasizes extent of exploration?", opts: ["fathomed", "seen", "discerned", "glanced"], ans: 0},
          {q: "Most accurate for '‚Ä¶bottom of pit B'?", opts: ["pit B", "section H", "section F", "section C"], ans: 0}
        ]
      }
    ];

    // ==================== STATE ====================
    let state = {
      screen: 'start',
      currentPassage: 0,
      currentQuestion: 0,
      score: 0,
      userAnswers: [],
      timeLeft: 35 * 60,
      timerInterval: null,
      totalQuestions: 44
    };

    // ==================== DOM ====================
    const startScreen = document.getElementById('startScreen');
    const quizScreen = document.getElementById('quizScreen');
    const endScreen = document.getElementById('endScreen');
    const reviewScreen = document.getElementById('reviewScreen');

    const timerDisplay = document.getElementById('timer');
    const counterDisplay = document.getElementById('counter');
    const passageBox = document.getElementById('passageBox');
    const questionHeader = document.getElementById('questionHeader');
    const questionText = document.getElementById('questionText');
    const optionsGroup = document.getElementById('optionsGroup');
    const feedback = document.getElementById('feedback');
    const nextBtn = document.getElementById('nextBtn');
    const scoreDisplay = document.getElementById('scoreDisplay');
    const scoreMessage = document.getElementById('scoreMessage');
    const reviewList = document.getElementById('reviewList');

    // ==================== EVENTS ====================
    document.getElementById('startBtn').addEventListener('click', startQuiz);
    nextBtn.addEventListener('click', nextQuestion);
    document.getElementById('reviewBtn').addEventListener('click', showReview);
    document.getElementById('restartBtn').addEventListener('click', () => location.reload());
    document.getElementById('backBtn').addEventListener('click', backToResults);

    // ==================== FUNCTIONS ====================
    function startQuiz() {
      console.log('START QUIZ CLICKED');
      state.screen = 'quiz';
      state.score = 0;
      state.userAnswers = [];
      state.currentPassage = 0;
      state.currentQuestion = 0;
      state.timeLeft = 35 * 60;

      startScreen.style.display = 'none';
      quizScreen.style.display = 'block';
      endScreen.style.display = 'none';
      reviewScreen.style.display = 'none';

      startTimer();
      renderQuestion();
    }

    function startTimer() {
      updateTimerDisplay();
      state.timerInterval = setInterval(() => {
        state.timeLeft--;
        updateTimerDisplay();
        if (state.timeLeft <= 0) {
          clearInterval(state.timerInterval);
          endQuiz(true);
        }
      }, 1000);
    }

    function updateTimerDisplay() {
      const mins = Math.floor(state.timeLeft / 60);
      const secs = state.timeLeft % 60;
      timerDisplay.textContent = `${String(mins).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;
    }

    function renderQuestion() {
      const passage = quizData[state.currentPassage];
      if (!passage) {
        endQuiz(false);
        return;
      }

      const question = passage.questions[state.currentQuestion];
      if (!question) {
        // Move to next passage
        state.currentPassage++;
        state.currentQuestion = 0;
        if (state.currentPassage < quizData.length) {
          renderQuestion();
        } else {
          endQuiz(false);
        }
        return;
      }

      const qNum = state.userAnswers.length + 1;

      questionHeader.textContent = `Question ${qNum}`;
      passageBox.textContent = passage.passage;
      questionText.textContent = question.q;
      counterDisplay.textContent = `Question ${qNum} of ${state.totalQuestions}`;

      optionsGroup.innerHTML = '';
      question.opts.forEach((opt, idx) => {
        const btn = document.createElement('button');
        btn.className = 'option-button';
        btn.textContent = `${String.fromCharCode(65 + idx)}) ${opt}`;
        btn.onclick = () => selectAnswer(idx, question.ans);
        optionsGroup.appendChild(btn);
      });

      feedback.textContent = '';
      feedback.className = 'feedback-message';
      nextBtn.disabled = true;
    }

    function selectAnswer(idx, correctAns) {
      const buttons = Array.from(optionsGroup.children);

      buttons.forEach(btn => btn.disabled = true);

      buttons[correctAns].classList.add('correct');
      if (idx !== correctAns) {
        buttons[idx].classList.add('incorrect');
      }

      if (idx === correctAns) {
        state.score++;
        feedback.textContent = '‚úì Correct!';
        feedback.classList.add('correct');
      } else {
        feedback.textContent = `‚úó Incorrect. Correct answer: ${String.fromCharCode(65 + correctAns)}`;
        feedback.classList.add('incorrect');
      }

      state.userAnswers.push({
        passageIndex: state.currentPassage,
        questionIndex: state.currentQuestion,
        userAnswer: idx,
        correctAnswer: correctAns,
        correct: idx === correctAns
      });

      nextBtn.disabled = false;
    }

    function nextQuestion() {
      const passage = quizData[state.currentPassage];

      if (state.currentQuestion < passage.questions.length - 1) {
        state.currentQuestion++;
        renderQuestion();
      } else {
        if (state.currentPassage < quizData.length - 1) {
          state.currentPassage++;
          state.currentQuestion = 0;
          renderQuestion();
        } else {
          endQuiz(false);
        }
      }
    }

    function endQuiz(timedOut) {
      clearInterval(state.timerInterval);
      state.screen = 'end';

      quizScreen.style.display = 'none';
      endScreen.style.display = 'block';

      scoreDisplay.textContent = `${state.score} / ${state.totalQuestions}`;
      const pct = Math.round((state.score / state.totalQuestions) * 100);
      scoreMessage.textContent = `You scored ${pct}% ${timedOut ? '(Time ran out)' : ''}`;
    }

    function showReview() {
      state.screen = 'review';
      endScreen.style.display = 'none';
      reviewScreen.style.display = 'block';

      reviewList.innerHTML = '';
      let wrongCount = 0;

      state.userAnswers.forEach((answer) => {
        if (!answer.correct) {
          wrongCount++;
          const passage = quizData[answer.passageIndex];
          const question = passage.questions[answer.questionIndex];

          const div = document.createElement('div');
          div.className = 'review-item';
          div.innerHTML = `
            <div class="review-item-title">Wrong Answer #${wrongCount}</div>
            <div class="review-item-passage">${passage.passage}</div>
            <div class="review-item-question"><strong>Q:</strong> ${question.q}</div>
            <div class="review-answer user"><strong>Your Answer:</strong> ${String.fromCharCode(65 + answer.userAnswer)}) ${question.opts[answer.userAnswer]}</div>
            <div class="review-answer correct"><strong>Correct Answer:</strong> ${String.fromCharCode(65 + answer.correctAnswer)}) ${question.opts[answer.correctAnswer]}</div>
          `;
          reviewList.appendChild(div);
        }
      });

      if (wrongCount === 0) {
        reviewList.innerHTML = '<p style="text-align:center; color:#28a745; font-size:16px;">Perfect! No wrong answers. üéâ</p>';
      }
    }

    function backToResults() {
      state.screen = 'end';
      endScreen.style.display = 'block';
      reviewScreen.style.display = 'none';
    }
  </script>
</body>
</html>

